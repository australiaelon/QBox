package main

// #include <stdlib.h>
// #include <stdint.h>
import "C"

import (
	"unsafe"

	"github.com/yourusername/rbox/librbox"
)

//export QBoxStart
func QBoxStart(configBase64 *C.char) C.uint64_t {

	configStr := C.GoString(configBase64)

	instanceID, err := librbox.StartWithBase64Config(configStr)
	if err != nil {
		return 0
	}

	return C.uint64_t(instanceID)
}

//export QBoxStop
func QBoxStop(instanceID C.uint64_t) C.int {

	id := uint64(instanceID)

	err := librbox.Stop(id)
	if err != nil {
		return C.int(0)
	}

	return C.int(1)
}

//export QBoxVersion
func QBoxVersion() *C.char {
	versionBase64, err := librbox.GetVersionBase64()
	if err != nil {
		return C.CString("")
	}

	return C.CString(versionBase64)
}

//export QBoxFreeString
func QBoxFreeString(str *C.char) {
	C.free(unsafe.Pointer(str))
}

func main() {
}
